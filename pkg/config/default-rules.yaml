# Plasma Shield Default Rules
# These rules provide baseline protection for AI agents.
# Customize as needed for your environment.

# NOTE: Plasma Shield operates at the NETWORK level.
# It can block domains, URLs, and request patterns.
# It CANNOT block local exec commands â€” use OS-level controls for that
# (limited user permissions, containers, seccomp, AppArmor).

rules:
  # ============================================
  # DANGEROUS DOMAINS
  # ============================================

  - id: block-pastebin
    domain: "pastebin.com"
    action: block
    description: "Block pastebin (common for malware hosting)"
    enabled: true

  - id: block-temp-file-hosts
    domain: "*.temp.sh"
    action: block
    description: "Block temporary file hosting services"
    enabled: true

  - id: block-transfer-sh
    domain: "transfer.sh"
    action: block
    description: "Block file transfer service"
    enabled: true

  - id: block-0x0
    domain: "0x0.st"
    action: block
    description: "Block anonymous file hosting"
    enabled: true

  # ============================================
  # CRYPTOCURRENCY MINING
  # ============================================

  - id: block-crypto-pools
    domain: "*pool.com"
    action: block
    description: "Block common mining pool domains"
    enabled: true

  - id: block-xmr-mining
    domain: "*xmr*"
    action: block
    description: "Block Monero mining domains"
    enabled: true

  - id: block-nicehash
    domain: "*.nicehash.com"
    action: block
    description: "Block NiceHash mining"
    enabled: true

  # ============================================
  # C2 / EXFILTRATION COMMON
  # ============================================

  - id: block-ngrok
    domain: "*.ngrok.io"
    action: block
    description: "Block ngrok tunnels (common for C2)"
    enabled: true

  - id: block-serveo
    domain: "serveo.net"
    action: block
    description: "Block serveo tunnels"
    enabled: true

  - id: block-localtunnel
    domain: "*.loca.lt"
    action: block
    description: "Block localtunnel"
    enabled: true

  # ============================================
  # REQUEST PATTERNS (HTTP inspection)
  # ============================================

  - id: block-sensitive-env-exfil
    url_pattern: "*env=*AWS_*"
    action: block
    description: "Block URLs containing AWS credentials in query params"
    enabled: true

  - id: block-api-key-exfil
    url_pattern: "*api_key=*"
    action: block
    description: "Block URLs with api_key in query params"
    enabled: true

# ============================================
# NOTES ON EXEC COMMAND FILTERING
# ============================================
#
# Commands like `rm -rf /` or `curl | bash` run LOCALLY on the agent.
# The shield cannot see or block them at the network level.
#
# Protect against destructive exec with:
#
# 1. Run agent as limited user (no root)
# 2. Use Docker with --cap-drop=ALL --read-only
# 3. Apply seccomp profiles to restrict syscalls
# 4. Use AppArmor/SELinux for mandatory access control
# 5. Restrict PATH to safe commands only
#
# See docs/exec-hardening.md for detailed guidance.
